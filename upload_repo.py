import os
import base64
from github import Github

# Access your GitHub account using your personal access token
# Replace 'YOUR_PERSONAL_ACCESS_TOKEN' with your actual access token
g = Github('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')

# Specify the repository name and owner
repo_name = 'PromptManagerv3'
repo_owner = 'Zabbist'

# Get the repository object
repo = g.get_repo(f'{repo_owner}/{repo_name}')

# Specify the local folder path containing the files to upload
local_folder_path = '/Users/macbook/Meus Ficheiros/Testes/ChatGPT EXT'

# Iterate over the files in the local folder
for file_name in os.listdir(local_folder_path):
    file_path = os.path.join(local_folder_path, file_name)
    # Check if the item is a file (not a subdirectory)
    if os.path.isfile(file_path):
        # Read the content of the local file in binary mode
        with open(file_path, 'rb') as file:
            content_bytes = file.read()

        # Encode the content using Base64 encoding
        content_base64 = base64.b64encode(content_bytes).decode('utf-8')

        # Create or update the file in the repository
        try:
            # Create the file
            repo.create_file(file_name, 'Upload file', content_base64, branch='main')
            print("Uploaded file:", file_name)
        except:
            # Update the file if it already exists
            file_in_repo = repo.get_contents(file_name)
            repo.update_file(file_in_repo.path, 'Update file', content_base64, file_in_repo.sha, branch='main')
            print("Updated file:", file_name)
